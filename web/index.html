<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SnapFlux Automation</title>
    <script src="/eel.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <img src="img/logo.png" alt="SnapFlux Logo" class="logo-image">
                <div class="logo-text">
                    <h1>SnapFlux</h1>
                </div>
            </div>
        </div>

        <nav class="sidebar-nav">
            <div class="nav-item active" onclick="showPage('dashboard')">
                <i class="fas fa-chart-simple"></i>
                <span>Dashboard</span>
            </div>
            <div class="nav-item" onclick="showPage('automation')">
                <i class="fas fa-bolt"></i>
                <span>Automation</span>
            </div>
            <div class="nav-item" onclick="showPage('results')">
                <i class="fas fa-file-lines"></i>
                <span>Results</span>
            </div>
            <div class="nav-item" onclick="showPage('settings')">
                <i class="fas fa-sliders"></i>
                <span>Settings</span>
            </div>
        </nav>

        <div class="sidebar-footer">
            <div class="flex items-center gap-2 text-sm text-muted">
                <div class="account-status-indicator processing"></div>
                <span id="status-text">Ready</span>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-wrapper">
        <!-- Header -->
        <header class="header">
            <h2 class="page-title" id="page-title">Dashboard</h2>
            <div class="flex items-center gap-4">
                <button class="btn btn-secondary text-sm" onclick="openResultsFolder()">
                    <i class="fas fa-folder-open"></i> Folder Output
                </button>
            </div>
        </header>

        <div class="container">

            <!-- DASHBOARD PAGE -->
            <section id="dashboard-page" class="page-section active">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="total-accounts">0</div>
                        <div class="stat-label">Total Akun</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="success-count" style="color: var(--success)">0</div>
                        <div class="stat-label">Berhasil</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="failed-count" style="color: var(--error)">0</div>
                        <div class="stat-label">Gagal</div>
                    </div>
                </div>

                <div class="card">
                    <h3 class="form-label mb-4">Progress Automation</h3>
                    <div class="flex justify-between text-sm text-muted mb-2">
                        <span id="progress-text">0/0</span>
                        <span id="progress-percent">0%</span>
                    </div>
                    <div style="height: 8px; background: var(--bg-input); border-radius: 4px; overflow: hidden;">
                        <div id="progress-bar"
                            style="width: 0%; height: 100%; background: var(--primary); transition: width 0.3s ease;">
                        </div>
                    </div>
                </div>
            </section>

            <!-- AUTOMATION PAGE -->
            <section id="automation-page" class="page-section">
                <div class="card mb-4">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="form-label" style="margin:0">Kontrol Automation</h3>
                        <div class="flex gap-2">
                            <button id="start-btn" class="btn btn-primary" onclick="startAutomation()">
                                <i class="fas fa-play"></i> Start
                            </button>
                            <button id="pause-btn" class="btn btn-secondary" onclick="pauseAutomation()" disabled>
                                <i class="fas fa-pause"></i> Pause
                            </button>
                            <button id="stop-btn" class="btn btn-danger" onclick="stopAutomation()" disabled>
                                <i class="fas fa-stop"></i> Stop
                            </button>
                        </div>
                    </div>

                    <div class="grid grid-cols-2 gap-4 mb-4"
                        style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <div class="form-group" style="margin:0">
                            <label class="form-label">File Excel Akun</label>
                            <div class="flex gap-2">
                                <select id="excel-file-select" class="form-select">
                                    <option value="">-- Pilih File --</option>
                                </select>
                                <button class="btn btn-secondary" onclick="loadAccounts()">
                                    <i class="fas fa-sync"></i> Load
                                </button>
                            </div>
                        </div>
                        <div class="form-group" style="margin:0">
                            <label class="form-label">Filter Tanggal (Opsional)</label>
                            <input type="date" id="date-filter" class="form-input">
                        </div>
                    </div>
                </div>

                <div id="account-info" class="flex justify-between items-center mb-4 hidden">
                    <div class="text-sm text-muted">
                        Total: <strong id="account-count">0</strong> akun
                    </div>
                    <button class="btn btn-secondary text-sm" onclick="toggleSelectAll()">
                        <i class="fas fa-check-double"></i> Pilih Semua
                    </button>
                </div>

                <!-- Account List Container -->
                <div class="card account-list-card">
                    <div class="card-header flex justify-between items-center mb-4">
                        <h3 class="form-label" style="margin:0">Daftar Akun</h3>
                        <span class="text-xs text-muted" id="account-count-badge">0 Akun</span>
                    </div>

                    <div id="accounts-list-view" class="account-scroll-container">
                        <div id="accounts-container" class="account-grid">
                            <!-- Accounts will be injected here -->
                            <div class="empty-state text-center py-8 text-muted">
                                <i class="fas fa-inbox text-4xl mb-2"></i>
                                <p>Belum ada akun dimuat</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Processing View (Hidden by default) -->
                <div id="processing-view" class="hidden">
                    <div class="processing-overlay">
                        <div class="processing-content card">
                            <div class="processing-loader"></div>
                            <h2 id="processing-name" class="text-2xl font-bold mb-1">Memuat...</h2>
                            <p id="processing-username" class="text-muted font-mono mb-4">---</p>

                            <div class="flex justify-center gap-8 mb-6 text-sm">
                                <div>
                                    <div class="text-muted">Urutan</div>
                                    <div class="font-bold text-lg"><span id="processing-current">0</span> / <span
                                            id="processing-total">0</span></div>
                                </div>
                                <div>
                                    <div class="text-muted">Status</div>
                                    <div id="processing-status" class="font-bold text-lg text-primary">Menunggu...</div>
                                </div>
                            </div>

                            <div class="max-w-md mx-auto mb-6">
                                <div class="flex justify-between text-sm mb-1">
                                    <span>Progress Akun</span>
                                    <span id="processing-percent">0%</span>
                                </div>
                                <div
                                    style="height: 6px; background: var(--bg-input); border-radius: 3px; overflow: hidden;">
                                    <div id="processing-progress-fill"
                                        style="width: 0%; height: 100%; background: var(--primary); transition: width 0.3s ease;">
                                    </div>
                                </div>
                            </div>

                            <button id="pause-btn-processing" class="btn btn-secondary" onclick="pauseAutomation()">
                                <i class="fas fa-pause"></i> Pause
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- RESULTS PAGE -->
            <section id="results-page" class="page-section">
                <div class="card mb-4">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="form-label" style="margin:0">Log Aktivitas</h3>
                        <button class="btn btn-secondary text-sm" onclick="clearLog()">
                            <i class="fas fa-trash"></i> Bersihkan
                        </button>
                    </div>
                    <div id="log-container" class="log-container">
                        <!-- Logs will appear here -->
                        <div class="log-entry">
                            <span class="log-time">[System]</span>
                            <span class="log-msg">Ready to start...</span>
                        </div>
                    </div>
                </div>

                <!-- Export Card (Hidden by default) -->
                <div id="export-card" class="card hidden text-center py-8">
                    <div class="mb-4">
                        <i class="fas fa-check-circle text-5xl text-green-500"></i>
                    </div>
                    <h3 class="text-2xl font-bold mb-2">Automation Selesai!</h3>
                    <p class="text-muted mb-6">Berhasil memproses <strong id="export-count">0</strong> akun.</p>
                    <div class="flex justify-center gap-4">
                        <button class="btn btn-primary" onclick="downloadExcel()">
                            <i class="fas fa-file-excel"></i> Download Excel
                        </button>
                        <button class="btn btn-secondary" onclick="openResultsFolder()">
                            <i class="fas fa-folder-open"></i> Buka Folder
                        </button>
                    </div>
                </div>
        </div>
        </section>

        <!-- SETTINGS PAGE -->
        <section id="settings-page" class="page-section">
            <div class="card max-w-2xl">
                <h3 class="form-label mb-6 text-lg">Pengaturan Umum</h3>

                <div class="form-group flex items-center justify-between">
                    <div>
                        <label class="form-label" style="margin:0">Headless Mode</label>
                        <p class="text-sm text-muted">Jalankan browser di background (tidak terlihat)</p>
                    </div>
                    <label class="toggle-wrapper">
                        <input type="checkbox" id="headless-toggle" class="toggle-checkbox" onchange="toggleHeadless()"
                            checked>
                        <div class="toggle-switch"></div>
                    </label>
                </div>

                <div class="form-group">
                    <label class="form-label">Delay Antar Aksi (detik)</label>
                    <input type="number" id="delay-input" class="form-input" value="2.0" step="0.5" min="0.5">
                    <p class="text-sm text-muted mt-2">Waktu jeda untuk menghindari deteksi bot.</p>
                </div>
            </div>
        </section>

        </div>
    </main>

    <script src="app.js"></script>
</body>

</html>